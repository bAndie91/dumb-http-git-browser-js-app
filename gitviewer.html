<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Git HTTP Browser</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <script src="./pako.min.js" sources="https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js"></script>
  <script src="./marked.min.js" sources="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  
  <style>
    html, body {
      margin: 0;
      height: 100%;
      font-family: sans-serif;
    }

    header {
      padding: 0.5em;
      border-bottom: 1px solid #ccc;
      display: flex;
      gap: 0.5em;
    }

    #app {
      height: calc(100% - 42px);
    }

    .panes {
      display: flex;
      width: 100%;
      height: calc(100vh - 42px);
      overflow: hidden;
    }
    
    .panes.horizontal {
      flex-direction: row;
    }
    
    .pane {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      min-width: 80px;
      overflow: hidden;
      border-right: 1px solid #ccc;
      padding: 0;
    }
    
    .pane > h3 {
      flex: 0 0 auto;
      background: #eee;
      padding: 4px 8px;
      margin: 0;
      font-weight: bold;
      border-bottom: 1px solid #ccc;
      position: sticky;
      top: 0;
      z-index: 2;
    }
    
    .pane-inner {
      overflow: auto;
      padding: 0 0.5em;
    }
    
    .splitter {
      background: #ccc;
      z-index: 10;
    }
    
    .splitter.vertical {
      width: 6px;
      cursor: col-resize;
    }
    
    .panes.vertical {
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    
    .panes.vertical > .pane {
      flex: 1;
      min-height: 50px;
      display: flex;
      flex-direction: column;
    }
    
    .splitter.horizontal {
      height: 6px;
      cursor: row-resize;
      background: #ccc;
    }
    
    .pane:last-child {
      border-right: none;
    }

    ul.dumbgitviewer, .dumbgitviewer ul {
      margin: 0;
      list-style: none;
      padding-left: 0;
    }

    .dumbgitviewer li {
      cursor: pointer;
      padding: 2px 4px;
    }

    .dumbgitviewer li:hover {
      background: #eee;
    }

    pre {
      white-space: pre;
      font-family: monospace;
      font-size: 0.9em;
    }

    @media (max-width: 900px) {
      .pane {
        border-right: none;
        border-bottom: 1px solid #ccc;
      }
    }
    
    .selected {
      background-color: #007acc22; /* light blue highlight */
      border-left: 3px solid #007acc; /* accent color */
      margin-left: -3px;
    }
    
    .git-commit-committer-datetime {
      color: #888;           /* subtle gray */
      font-size: 0.85em;     /* slightly smaller */
      white-space: nowrap;    /* never wrap */
      margin-right: 10px;     /* spacing before message */
    }
    .git-commit-message-subject {
      color: #222;           /* primary color */
      font-weight: 500;
      overflow-wrap: anywhere; /* wrap long messages nicely */
      flex: 1;               /* take remaining space */
    }
    
    #commits-loader button {
      margin: 0.25em;
    }
    
    .file-content-placeholder {
      background-color: grey;
    }
    
    .renderPOD .pod-command-unknown {
      background-color: lightgrey;
    }
    .renderPOD em {
      color: darkcyan;
    }
    .renderPOD .manpage-reference {
      text-decoration: dotted underline;
    }
  </style>
</head>

<body>
  <header>
    <input id="repoUrl" size="50" placeholder="https://example.com/repo.git" />
    <button id="loadRepoBtn">Load</button>
    <span id="status"></span>
  </header>

  <div id="app">
    <div id="panes-main" class="panes horizontal">
      <div class="pane">
        <h3>Refs</h3>
        <div class="pane-inner">
          <ul id="refs" class="dumbgitviewer"></ul>
        </div>
      </div>
      
      <div class="splitter vertical"></div>
  
      <div class="pane">
        <h3>Log</h3>
        <div id="panes-column-log" class="panes vertical">
          <div class="pane">
            <div id="commits-loader" class="pane-inner">
              <ul id="commits" class="dumbgitviewer"></ul>
            </div>
          </div>
          
          <div class="splitter horizontal"></div>
          
          <div class="pane">
            <h3>Commit</h3>
            <div id="commitDetails" class="pane-inner">
            </div>
          </div>
        </div>
      </div>
      
      <div class="splitter vertical"></div>
  
      <div class="pane">
        <h3>Tree</h3>
        <div class="pane-inner">
          <ul id="tree" class="dumbgitviewer"></ul>
        </div>
      </div>
      
      <div class="splitter vertical"></div>
  
      <div class="pane">
        <h3>File</h3>
        <div class="pane-inner">
          <div id="file"></div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="./gitviewer-ui.js"></script>
  <script type="module" src="./gitviewer.js"></script>
</body>
</html>
